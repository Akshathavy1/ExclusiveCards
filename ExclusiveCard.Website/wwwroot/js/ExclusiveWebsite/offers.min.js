var Offers = function () { "use strict"; var e, t = []; function n(e, t) { var n = $.Deferred(); return $("#infoMessage").html(t), $("#dialog-confirm").dialog({ title: e, draggable: !1, autoResize: !0, resizable: !1, open: function () { $(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide() }, modal: !0, buttons: { Close: { id: "btnYesId", text: "Close", click: function () { $("#infoMessage").html(""), $(this).dialog("close"), n.resolve("Yes") }, class: "btnYes" } } }), n.promise() } function i(e) { var t = "/Offers/DisplayOffer?country=" + countrySelected, n = "", i = ""; t = t + "&pagenumber=" + e, $("#categoryTree ul.sim-tree > li").each(function (e, t) { $(t).find("a:first .sim-tree-checkbox").hasClass("checked") ? n = n + $(this).find("a:first .sim-tree-checkbox").attr("uslug") + "," : $(t).find("a:first .sim-tree-checkbox").hasClass("sim-tree-semi") && $(this).find("ul li").each(function (e, t) { $(t).find("a:first .sim-tree-checkbox").hasClass("checked") && (n = n + $(this).find("a:first .sim-tree-checkbox").attr("uslug") + ",") }) }), n.length > 0 && (t = t + "&searchCategories=" + (n = n.substring(0, n.length - 1))), $("#offerTypeTree .custom-checkbox.checked").each(function (e) { "Cashback" === $.trim($(this).closest("a").text()) && (i += "Standard Cashback,"), i = i + $.trim($(this).closest("a").text()) + "," }), i.length > 0 && (t = t + "&searchOfferTypes=" + (i = i.substring(0, i.length - 1))), null !== $("input[name='MerchantName_input']").val() && "" !== $("input[name='MerchantName_input']").val() && void 0 !== $("input[name='MerchantName_input']").val() && (t = t + "&merchant=" + $("input[name='MerchantName_input']").val()), null !== $("#Keywords").val() && "" !== $("#Keywords").val() && (t = t + "&keyword=" + $("#Keywords").val()), window.location.href = t } function a(e, t) { var n = t; $(e).each(function () { var e = $(this).text().trim(), t = e.slice(0, n) + "<span class='ellipsis'>&nbsp;</span><a href='#' class='more'>Read more</a><span style='display:none'>" + e.slice(n, e.length) + "<a href='#' class='less'>Hide</a></span>"; e.length < n || $(this).html(t) }), $(".more").click(function (e) { e.preventDefault(), $(this).hide().prev().hide(), $(this).next().show() }), $(".less").click(function (e) { e.preventDefault(), $(this).parent().hide().prev().show().prev().show() }) } function r() { this.classList.toggle("active"), this.nextElementSibling.classList.toggle("active") } function c() { $(window).unload(function () { window.location.href = "/Account/Logout" }), $("#btnApply").unbind().click(function (e) { e.preventDefault(), $(this).prop("disabled", !1), i(1) }), $("#offersResult #pager a").each(function () { $(this).unbind().click(function (e) { e.preventDefault(); var t = $(this).attr("pagenumber"); "" !== $("input[name='mainSearch_input']").val() ? function (e) { var t = "/Offers/SearchByText?country=" + countrySelected; t = t + "&pageNumber=" + e + "&mainSearchTerm=" + $("input[name='mainSearch_input']").val(), window.location.href = t }(t) : i(t) }) }), $(".merchtbranchfnt #pager a").each(function () { $(this).unbind().click(function (e) { e.preventDefault(); var t, n, i = $(this).attr("pagenumber"), r = $(".merchtbranchfnt").attr("MerchantId"); t = i, n = r, $.ajax({ url: "/Offers/GetPagedBranchContact?merchantId=" + n + "&currentPage=" + t, beforeSend: function () { }, type: "GET", contentType: !1, processData: !1, cache: !1, complete: function () { $(".spinner").hide() }, success: function (e) { e ? ($(".merchtbranchfnt").html(e), c(), a(".rdfull", 50)) : toastr.error(e) }, error: function (e, t, n) { toastr.error(e.responseText) } }), $("html, body").animate({ scrollTop: $(".newmerchbck").offset().top }, 500) }) }), $(".termpop").unbind().click(function (e) { e.preventDefault(), $(this).addClass("visitlink"); var t = $(this).children("#Terms")[0].value; null !== t && "" !== t && $.when(n("Terms", t)) }), $(".inspop").unbind().click(function (e) { e.preventDefault(), $(this).addClass("visitlink"); var t = $(this).children("#Instructions")[0].value; null != t && "" != t && $.when(n("Instructions", t)) }), $(".exlpop").unbind().click(function (e) { e.preventDefault(), $(this).addClass("visitlink"); var t = $(this).children("#Exclusions")[0].value; null != t && "" != t && $.when(n("Exculsion", t)) }), $(".codepop").unbind().click(function (e) { e.preventDefault(); var t = $(this).children("#Code")[0].value; null != t && "" != t && $.when(n("Get Code", t)) }), $("a, button").click(function () { $(this).toggleClass("active") }), $("#MerchantName").on("change", function () { !0 }), $("#Keywords").on("change", function () { !0 }), $(".category").unbind().click(function (e) { e.preventDefault(); var t = $(this).text(); window.location.href = "/Offers/DisplayOffer/?country=" + countrySelected + "&searchCategories=" + encodeURIComponent(t) }), $(".btn-cashback").unbind().click(function (e) { e.preventDefault(); var t = $(this).attr("merchantId"); window.location.href = "/Offers/Index/?country=" + countrySelected + "&merchantId=" + t }), $(".btnDetailCashback").unbind().click(function (e) { e.preventDefault(); var t = $(this).attr("linkurl"); if (userSignedIn && "1" === t) { var n = $(this).attr("offerId"); $('<a href="/Offers/Redirect/?country=' + countrySelected + "&offerId=" + n + '" target="_blank"></a>')[0].click() } else userSignedIn ? "0" === t && toastr.error("Merchant url missing.") : toastr.error("Please Login/Signup to continue.") }), $(".btnStandardCashback").unbind().click(function (e) { e.preventDefault(); var t = $("#Standard_0__DeepLinkAvailable").val(); if (userSignedIn && "true" === t.toLowerCase()) { var n = $(this).attr("offerId"); $('<a href="/Offers/Redirect/?country=' + countrySelected + "&offerId=" + n + '" target="_blank"></a>')[0].click() } else userSignedIn ? "false" === t.toLowerCase() && toastr.error("Merchant url missing.") : toastr.error("Please Login/Signup to continue.") }) } return document.querySelectorAll(".accordion a").forEach(e => e.addEventListener("click", r)), { setUpEvents: c, setOfferTypes: function (e) { simTree({ linkParent: !1, response: { name: "Description", id: "Id", pid: 0, checked: "IsActive", expand: "expand", disabled: "disabled" }, el: "#offerTypeTree", data: e, check: !0, childNodeAsy: !1, onChange: function () { !0 } }) }, setCategories: function (e) { simTree({ linkParent: !0, response: { name: "Name", id: "Id", pid: "ParentId", checked: "IsActive", expand: "expand", disabled: "disabled", slug: "UrlSlug" }, el: "#categoryTree", data: e, check: !0, childNodeAsy: !1, onChange: function () { !0 } }), $(".customTreeView a[href = 'javascript:;']").click(function (e) { !0, $(this).children("i").hasClass("checked") ? $(this).children("i").removeClass("checked") : $(this).children("i").addClass("checked") }) }, setTags: function (n) { e = n, $.each(e, function (n) { t.push(e[n].Tags) }) }, tagAutoComplete: function () { $("#Keywords").autocomplete({ source: t }) }, kendoUIBind: function () { $("#MerchantName").kendoComboBox({ filter: "contains" }) }, merchantmoreLess: function () { a(".merchtrdfull", 600) } } }();