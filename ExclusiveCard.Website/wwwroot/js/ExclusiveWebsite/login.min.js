var Login = function () { "use strict"; var e; document.createElement("a"); function t(e) { var t = ""; null !== e && (t = e.serialize()), $.ajax({ url: "/Account/Login", beforeSend: function () { $(".spinner").show() }, type: "POST", data: t, cache: !1, complete: function () { $(".spinner").hide() }, success: function (e) { var t, n, a; e.success ? window.location.href.indexOf("/Account") > -1 ? window.location.href = "/Home/" : location.reload() : ($("#btnLogin").prop("disabled", !1), $.when((t = "Login Failed", n = e.errorMessage, a = $.Deferred(), $("#infoMessage").html(n), $("#dialog-confirm").dialog({ title: t, draggable: !1, autoResize: !0, resizable: !1, open: function () { $(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide() }, modal: !0, buttons: { Close: { id: "btnYesId", text: "Close", click: function () { $("#infoMessage").html(""), $(this).dialog("close"), a.resolve("Yes") }, class: "btnYes" } } }), a.promise()))) }, error: function (e, t, n) { $("#btnLogin").prop("disabled", !1), toastr.error(e.responseText) } }) } function n(e) { window.location.href = "/Offers/SearchByText?country=" + countrySelected + "&pageNumber=1&mainSearchTerm=" + e } function a(e, t, n, a, o, r) { var i = "/Account/AccountStatement/?customerId=" + t + "&cardId=" + e; "" !== r && null != r ? i = i + "&currentPage=" + r : i += "&currentPage=1", "" !== n && null != n && (i = i + "&accountStatus=" + n), "" !== a && null != a && (i = i + "&validFrom=" + a), "" !== o && null != o && (i = i + "&validTo=" + o), window.location.href = i } return $(function () { var e = $("div.mm-dropdown .textfirst"), t = $("div.mm-dropdown > ul > li.input-option"), n = $("div.mm-dropdown .option"); e.click(function () { t.toggle("fast") }), t.click(function () { t.toggle("fast"); var a = $(this).data("value"), o = $(this).html(); o += "<img src='/images/icon-arrow-down.png' data-src='/images/icon-arrow-down.png'  data-srcset='/images/icon-arrow-down.png' class='lazy' width='20' height='20'>", e.html(o), n.val(a) }) }), $(function () { var e = $("div.mm-dropdowns .textfirst"), t = $("div.mm-dropdowns > ul > li.input-option"), n = $("div.mm-dropdowns .option"); e.click(function () { t.toggle("fast") }), t.click(function () { t.toggle("fast"); var a = $(this).data("value"), o = $(this).html(); o += "<img src='/images/icon-arrow-down.png' data-src='/images/icon-arrow-down.png'  data-srcset='/images/icon-arrow-down.png' class='lazy' width='20' height='20'>", e.html(o), n.val(a) }) }), { setUpEvents: function (o) { null == o && (o = "GB"), $("#setCountry").html('<img src="/images/' + o + '_Flag.png" width="20" height="20"/>&nbsp;&nbsp;<img src="/images/icon-arrow-down.png"  data-src="/images/icon-arrow-down.png"  data-srcset="/images/icon-arrow-down.png" class="lazy" width="20" height="20" />'), $(window).unload(function () { window.location.href = "/Account/Logout" }), $("#btnLogin").unbind().click(function (e) { e.preventDefault(), $(this).prop("disabled", !0); var n = $(this).closest("form"); n.valid() ? t(n) : ($(this).toggleClass("active"), $(this).prop("disabled", !1)) }), $("#logoutBtn").unbind().click(function (e) { $.get("/Account/Logout", "", function (e, t, n) { e.success ? location.reload() : toastr.error(e.errorMessage) }) }), $(".category").unbind().click(function (t) { t.preventDefault(); var n = $(this).attr("uslug"), a = ""; $(e).each(function (t) { a = a + e[t].description + "," }), a.length > 0 ? (a = a.substring(0, a.length - 1), window.location.href = "/Offers/DisplayOffer/?country=" + o + "&searchCategories=" + encodeURIComponent(n) + "&searchOfferTypes=" + encodeURIComponent(a) + "&parentCategory=true") : window.location.href = "/Offers/DisplayOffer/?country=" + o + "&searchCategories=" + encodeURIComponent(n) + "&parentCategory=true" }), $(".btnHomeCashback").unbind().click(function (e) { e.preventDefault(); var t = $(this).attr("merchantId"), n = $(this).attr("offerId"); "" !== t && "" !== n ? window.location.href = "/Offers/Index/?country=" + o + "&merchantId=" + t + "&offerId=" + n : "" !== t && "" === n && (window.location.href = "/Offers/Index/?country=" + o + "&merchantId=" + t) }), $("#ForgotPassword").unbind().click(function (e) { e.preventDefault(); var t = $("#Username").val(); "" !== t ? $.ajax({ url: "/Account/ForgotPassword?username=" + t, beforeSend: function () { $(".spinner").show() }, type: "POST", data: null, cache: !1, complete: function () { $(".spinner").hide() }, success: function (e) { e.success ? toastr.success("An email has been sent to you with a link in to reset your password. Please check your email to continue.") : toastr.error(e.errorMessage) }, error: function (e, t, n) { toastr.error(e.responseText) } }) : toastr.error("Email is required") }), $("a, button").click(function () { $(this).toggleClass("active") }), $("#mainSearch").keyup(function (e) { if (13 === e.keyCode) { var t = $("#mainSearch").val(); t.length > 2 && ($(this).addClass("loading"), n(t)) } }), $("#SubmitAnswer").unbind().click(function (e) { e.preventDefault(), $(this).prop("disabled", !0); var t = $("#UserAnswer").val(), n = $("#Answer").val(); "" !== t ? t === n ? ($("#QuestionsDiv").addClass("hidden"), $("#ResetPasswordDiv").removeClass("hidden")) : ($(this).prop("disabled", !1), toastr.error("please provide valid answer")) : ($(this).prop("disabled", !1), toastr.error("please provide answer")) }), $("#SubmitPassword").unbind().click(function (e) { e.preventDefault(), $(this).prop("disabled", !0); var t = $("#NewPassword").val(), n = ($("#ConfirmPassword").val(), $(this).closest("form").valid()), a = $("#Username").val(); n ? ($(this).toggleClass("active"), $.ajax({ url: "/Account/SaveNewPassword?username=" + a + "&password=" + t, beforeSend: function () { $(".spinner").show() }, type: "POST", data: null, cache: !1, complete: function () { $(".spinner").hide() }, success: function (e) { e.success ? (toastr.success("Your password has been reset. Please try logging in again."), setTimeout(function () { window.location.href = "/Home/", $("#LoginModal").modal("show") }, 1500)) : toastr.error("An Error has occured. Please try again") }, error: function (e, t, n) { $(this).prop("disabled", !1), toastr.error(e.responseText) } })) : ($(this).prop("disabled", !1), toastr.error("please provide all required fields")) }), $(".highstreetImg").unbind().click(function (e) { window.location.href = "/Offers/Index?country=" + o + "&merchantId=" + $(this).attr("merchantId") + "&offerId=" + $(this).attr("offerId") }), $("#MembershipCardId").change(function (e) { e.preventDefault(); var t = $(this).find(":selected").val(), n = $("#CustomerId").val(), o = $("#AccountStatus").val(), r = $("#ValidFrom").val(), i = $("#ValidTo").val(), s = $("#statementPaging #pager a").attr("pagenumber"); "" === t && "" === n && "" === o && "" === r && "" === i && "" === s || a(t, n, o, r, i, s) }), $("#statementPaging #pager a").each(function () { $(this).unbind().click(function (e) { e.preventDefault(), function (e, t, n, a, o, r) { var i = "/Account/AccountStatement/?customerId=" + t + "&cardId=" + n; "" !== e && null != e ? i = i + "&currentPage=" + e : i += "&currentPage=1", "" !== a && null != a && (i = i + "&accountStatus=" + a), "" !== o && null != o && (i = i + "&validFrom=" + o), "" !== r && null != r && (i = i + "&validTo=" + r), window.location.href = i }($(this).attr("pagenumber"), $(this).closest("#CustomerId"), $(this).closest("#CardId"), $(this).closest("#AccountStatus"), $("#ValidFrom").val(), $("#ValidTo").val()) }) }), $("#ValidFrom").blur(function (e) { e.preventDefault(); var t = $("#CardId").find(":selected").val(), n = $("#CustomerId").val(), o = $("#AccountStatus").val(), r = $("#ValidFrom").val(), i = $("#ValidTo").val(), s = $("#statementPaging #pager a").attr("pagenumber"); "" === t && "" === n && "" === o && "" === r && "" === i && "" === s || a(t, n, o, r, i, s) }), $("#ValidFrom").keyup(function (e) { if (e.preventDefault(), 13 === event.keyCode) { var t = $("#CardId").find(":selected").val(), n = $("#CustomerId").val(), o = $("#AccountStatus").val(), r = $("#ValidFrom").val(), i = $("#ValidTo").val(), s = $("#statementPaging #pager a").attr("pagenumber"); "" === t && "" === n && "" === o && "" === r && "" === i && "" === s || a(t, n, o, r, i, s) } }), $("#ValidTo").blur(function (e) { e.preventDefault(); var t = $("#CardId").find(":selected").val(), n = $("#CustomerId").val(), o = $("#AccountStatus").val(), r = $("#ValidFrom").val(), i = $("#ValidTo").val(), s = $("#statementPaging #pager a").attr("pagenumber"); "" === t && "" === n && "" === o && "" === r && "" === i && "" === s || a(t, n, o, r, i, s) }), $("#ValidTo").keyup(function (e) { if (e.preventDefault(), 13 === event.keyCode) { var t = $("#CardId").find(":selected").val(), n = $("#CustomerId").val(), o = $("#AccountStatus").val(), r = $("#ValidFrom").val(), i = $("#ValidTo").val(), s = $("#statementPaging #pager a").attr("pagenumber"); "" === t && "" === n && "" === o && "" === r && "" === i && "" === s || a(t, n, o, r, i, s) } }), $(".input-option").click(function (e) { e.preventDefault(); var t = $(this).attr("data-value"), n = window.location.href.split("?"), a = -1; "" !== n[1] && void 0 !== n[1] && null !== n[1] && (a = n[1].indexOf("country")), a > -1 && "" !== n[1] && void 0 !== n[1] && null !== n[1] && (n[1] = n[1].substring(10)); var o = n[0] + "?country=" + t; "" !== n[1] && void 0 !== n[1] && null !== n[1] && (a > -1 ? o += n[1] : o = o + "&" + n[1]), window.location.href = o }) }, setHomeOfferTypes: function (t) { e = t }, searchCriteria: n, moreLess: function () { var e; e = 50, $(".rdfull").each(function () { var t = $(this).text().trim(), n = t.slice(0, e) + "<span class='ellipsis'>&nbsp;</span><a href='#' class='more'>Read more</a><span style='display:none'>" + t.slice(e, t.length) + "<a href='#' class='less'> Hide</a></span>"; t.length < e || $(this).html(n) }), $(".more").click(function (e) { e.preventDefault(), $(this).hide().prev().hide(), $(this).next().show() }), $(".less").click(function (e) { e.preventDefault(), $(this).parent().hide().prev().show().prev().show() }) }, kendoUIBind: function () { $("#mainSearch").kendoComboBox({ filter: "contains", highlightFirst: !1 }) }, customMoreLess: function () { var e; e = 50, $(".rowMore").each(function () { var t = $(this).text().trim(), n = t.slice(0, e) + "<span class='ellipsis'>&nbsp;</span><a href='#' class='tmore'>Read more</a>"; t.length < e || $(this).html(n) }), $(".tmore").click(function (e) { e.preventDefault(), $(this).parent().hide().next().show() }), $(".tless").click(function (e) { e.preventDefault(), $(this).parent().hide().prev().show() }) } } }();