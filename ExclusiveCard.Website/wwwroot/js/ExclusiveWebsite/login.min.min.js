var Login=function(){"use strict";function r(n){var t="";null!==n&&(t=n.serialize());$.ajax({url:"/Account/Login",beforeSend:function(){$(".spinner").show()},type:"POST",data:t,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){var i,r,t;n.success?window.location.href.indexOf("/Account")>-1?window.location.href="/Home/":location.reload():($("#btnLogin").prop("disabled",!1),$.when((i="Login Failed",r=n.errorMessage,t=$.Deferred(),$("#infoMessage").html(r),$("#dialog-confirm").dialog({title:i,draggable:!1,autoResize:!0,resizable:!1,open:function(){$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()},modal:!0,buttons:{Close:{id:"btnYesId",text:"Close",click:function(){$("#infoMessage").html("");$(this).dialog("close");t.resolve("Yes")},"class":"btnYes"}}}),t.promise())))},error:function(n){$("#btnLogin").prop("disabled",!1);toastr.error(n.responseText)}})}function i(n){window.location.href="/Offers/SearchByText?country="+countrySelected+"&pageNumber=1&mainSearchTerm="+n}function n(n,t,i,r,u,f){var e="/Account/AccountStatement/?customerId="+t+"&cardId="+n;""!==f&&null!=f?e=e+"&currentPage="+f:e+="&currentPage=1";""!==i&&null!=i&&(e=e+"&accountStatus="+i);""!==r&&null!=r&&(e=e+"&validFrom="+r);""!==u&&null!=u&&(e=e+"&validTo="+u);window.location.href=e}var t;return document.createElement("a"),$(function(){var t=$("div.mm-dropdown .textfirst"),n=$("div.mm-dropdown > ul > li.input-option"),i=$("div.mm-dropdown .option");t.click(function(){n.toggle("fast")});n.click(function(){n.toggle("fast");var u=$(this).data("value"),r=$(this).html();r+="<img src='/images/icon-arrow-down.png' data-src='/images/icon-arrow-down.png'  data-srcset='/images/icon-arrow-down.png' class='lazy' width='20' height='20'>";t.html(r);i.val(u)})}),$(function(){var t=$("div.mm-dropdowns .textfirst"),n=$("div.mm-dropdowns > ul > li.input-option"),i=$("div.mm-dropdowns .option");t.click(function(){n.toggle("fast")});n.click(function(){n.toggle("fast");var u=$(this).data("value"),r=$(this).html();r+="<img src='/images/icon-arrow-down.png' data-src='/images/icon-arrow-down.png'  data-srcset='/images/icon-arrow-down.png' class='lazy' width='20' height='20'>";t.html(r);i.val(u)})}),{setUpEvents:function(u){null==u&&(u="GB");$("#setCountry").html('<img src="/images/'+u+'_Flag.png" width="20" height="20"/>&nbsp;&nbsp;<img src="/images/icon-arrow-down.png"  data-src="/images/icon-arrow-down.png"  data-srcset="/images/icon-arrow-down.png" class="lazy" width="20" height="20" />');$(window).unload(function(){window.location.href="/Account/Logout"});$("#btnLogin").unbind().click(function(n){n.preventDefault();$(this).prop("disabled",!0);var t=$(this).closest("form");t.valid()?r(t):($(this).toggleClass("active"),$(this).prop("disabled",!1))});$("#logoutBtn").unbind().click(function(){$.get("/Account/Logout","",function(n){n.success?location.reload():toastr.error(n.errorMessage)})});$(".category").unbind().click(function(n){n.preventDefault();var r=$(this).attr("uslug"),i="";$(t).each(function(n){i=i+t[n].description+","});i.length>0?(i=i.substring(0,i.length-1),window.location.href="/Offers/DisplayOffer/?country="+u+"&searchCategories="+encodeURIComponent(r)+"&searchOfferTypes="+encodeURIComponent(i)+"&parentCategory=true"):window.location.href="/Offers/DisplayOffer/?country="+u+"&searchCategories="+encodeURIComponent(r)+"&parentCategory=true"});$(".btnHomeCashback").unbind().click(function(n){n.preventDefault();var t=$(this).attr("merchantId"),i=$(this).attr("offerId");""!==t&&""!==i?window.location.href="/Offers/Index/?country="+u+"&merchantId="+t+"&offerId="+i:""!==t&&""===i&&(window.location.href="/Offers/Index/?country="+u+"&merchantId="+t)});$("#ForgotPassword").unbind().click(function(n){n.preventDefault();var t=$("#Username").val();""!==t?$.ajax({url:"/Account/ForgotPassword?username="+t,beforeSend:function(){$(".spinner").show()},type:"POST",data:null,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?toastr.success("An email has been sent to you with a link in to reset your password. Please check your email to continue."):toastr.error(n.errorMessage)},error:function(n){toastr.error(n.responseText)}}):toastr.error("Email is required")});$("a, button").click(function(){$(this).toggleClass("active")});$("#mainSearch").keyup(function(n){if(13===n.keyCode){var t=$("#mainSearch").val();t.length>2&&($(this).addClass("loading"),i(t))}});$("#SubmitAnswer").unbind().click(function(n){n.preventDefault();$(this).prop("disabled",!0);var t=$("#UserAnswer").val(),i=$("#Answer").val();""!==t?t===i?($("#QuestionsDiv").addClass("hidden"),$("#ResetPasswordDiv").removeClass("hidden")):($(this).prop("disabled",!1),toastr.error("please provide valid answer")):($(this).prop("disabled",!1),toastr.error("please provide answer"))});$("#SubmitPassword").unbind().click(function(n){n.preventDefault();$(this).prop("disabled",!0);var t=$("#NewPassword").val(),i=($("#ConfirmPassword").val(),$(this).closest("form").valid()),r=$("#Username").val();i?($(this).toggleClass("active"),$.ajax({url:"/Account/SaveNewPassword?username="+r+"&password="+t,beforeSend:function(){$(".spinner").show()},type:"POST",data:null,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?(toastr.success("Your password has been reset. Please try logging in again."),setTimeout(function(){window.location.href="/Home/";$("#LoginModal").modal("show")},1500)):toastr.error("An Error has occured. Please try again")},error:function(n){$(this).prop("disabled",!1);toastr.error(n.responseText)}})):($(this).prop("disabled",!1),toastr.error("please provide all required fields"))});$(".highstreetImg").unbind().click(function(){window.location.href="/Offers/Index?country="+u+"&merchantId="+$(this).attr("merchantId")+"&offerId="+$(this).attr("offerId")});$("#MembershipCardId").change(function(t){t.preventDefault();var i=$(this).find(":selected").val(),r=$("#CustomerId").val(),u=$("#AccountStatus").val(),f=$("#ValidFrom").val(),e=$("#ValidTo").val(),o=$("#statementPaging #pager a").attr("pagenumber");""===i&&""===r&&""===u&&""===f&&""===e&&""===o||n(i,r,u,f,e,o)});$("#statementPaging #pager a").each(function(){$(this).unbind().click(function(n){n.preventDefault(),function(n,t,i,r,u,f){var e="/Account/AccountStatement/?customerId="+t+"&cardId="+i;""!==n&&null!=n?e=e+"&currentPage="+n:e+="&currentPage=1";""!==r&&null!=r&&(e=e+"&accountStatus="+r);""!==u&&null!=u&&(e=e+"&validFrom="+u);""!==f&&null!=f&&(e=e+"&validTo="+f);window.location.href=e}($(this).attr("pagenumber"),$(this).closest("#CustomerId"),$(this).closest("#CardId"),$(this).closest("#AccountStatus"),$("#ValidFrom").val(),$("#ValidTo").val())})});$("#ValidFrom").blur(function(t){t.preventDefault();var i=$("#CardId").find(":selected").val(),r=$("#CustomerId").val(),u=$("#AccountStatus").val(),f=$("#ValidFrom").val(),e=$("#ValidTo").val(),o=$("#statementPaging #pager a").attr("pagenumber");""===i&&""===r&&""===u&&""===f&&""===e&&""===o||n(i,r,u,f,e,o)});$("#ValidFrom").keyup(function(t){if(t.preventDefault(),13===event.keyCode){var i=$("#CardId").find(":selected").val(),r=$("#CustomerId").val(),u=$("#AccountStatus").val(),f=$("#ValidFrom").val(),e=$("#ValidTo").val(),o=$("#statementPaging #pager a").attr("pagenumber");""===i&&""===r&&""===u&&""===f&&""===e&&""===o||n(i,r,u,f,e,o)}});$("#ValidTo").blur(function(t){t.preventDefault();var i=$("#CardId").find(":selected").val(),r=$("#CustomerId").val(),u=$("#AccountStatus").val(),f=$("#ValidFrom").val(),e=$("#ValidTo").val(),o=$("#statementPaging #pager a").attr("pagenumber");""===i&&""===r&&""===u&&""===f&&""===e&&""===o||n(i,r,u,f,e,o)});$("#ValidTo").keyup(function(t){if(t.preventDefault(),13===event.keyCode){var i=$("#CardId").find(":selected").val(),r=$("#CustomerId").val(),u=$("#AccountStatus").val(),f=$("#ValidFrom").val(),e=$("#ValidTo").val(),o=$("#statementPaging #pager a").attr("pagenumber");""===i&&""===r&&""===u&&""===f&&""===e&&""===o||n(i,r,u,f,e,o)}});$(".input-option").click(function(n){var i;n.preventDefault();var u=$(this).attr("data-value"),t=window.location.href.split("?"),r=-1;""!==t[1]&&void 0!==t[1]&&null!==t[1]&&(r=t[1].indexOf("country"));r>-1&&""!==t[1]&&void 0!==t[1]&&null!==t[1]&&(t[1]=t[1].substring(10));i=t[0]+"?country="+u;""!==t[1]&&void 0!==t[1]&&null!==t[1]&&(r>-1?i+=t[1]:i=i+"&"+t[1]);window.location.href=i})},setHomeOfferTypes:function(n){t=n},searchCriteria:i,moreLess:function(){var n;n=50;$(".rdfull").each(function(){var t=$(this).text().trim(),i=t.slice(0,n)+"<span class='ellipsis'>&nbsp;<\/span><a href='#' class='more'>Read more<\/a><span style='display:none'>"+t.slice(n,t.length)+"<a href='#' class='less'> Hide<\/a><\/span>";t.length<n||$(this).html(i)});$(".more").click(function(n){n.preventDefault();$(this).hide().prev().hide();$(this).next().show()});$(".less").click(function(n){n.preventDefault();$(this).parent().hide().prev().show().prev().show()})},kendoUIBind:function(){$("#mainSearch").kendoComboBox({filter:"contains",highlightFirst:!1})},customMoreLess:function(){var n;n=50;$(".rowMore").each(function(){var t=$(this).text().trim(),i=t.slice(0,n)+"<span class='ellipsis'>&nbsp;<\/span><a href='#' class='tmore'>Read more<\/a>";t.length<n||$(this).html(i)});$(".tmore").click(function(n){n.preventDefault();$(this).parent().hide().next().show()});$(".tless").click(function(n){n.preventDefault();$(this).parent().hide().prev().show()})}}}();