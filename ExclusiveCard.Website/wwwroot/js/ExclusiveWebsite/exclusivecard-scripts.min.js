var Account=function(){"use strict";function i(n,t){var i=$.Deferred();return $("#infoMessage").html(t),$("#dialog-confirm").dialog({title:n,draggable:!1,autoResize:!0,resizable:!1,open:function(){var n=$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close");n.hide()},modal:!0,buttons:{Close:{id:"btnYesId",text:"Close",click:function(){$("#infoMessage").html("");$(this).dialog("close");i.resolve("Yes")},"class":"btnYes"}}}),i.promise()}function f(n){var r=$("#PaidByEmployer").val(),u=$("#DiamondUpgrade").val(),i="";n!==null&&(i=n.serialize());$.ajax({url:"/Account/Save",beforeSend:function(){},type:"POST",data:i,cache:!1,complete:function(){},success:function(n){n.success?(n.data.id>0&&window.buttonLoading(document.querySelector("#btnContinue"),!1,t),setTimeout(function(){window.location.href=(r==="false"||r==="False")&&(u==="true"||u==="True")?"/Home":"/Home"},1500)):(window.buttonLoading(document.querySelector("#btnContinue"),!1,t),$("#customError").html(n.errorMessage),$("#customError").removeClass("hideContent"),window.scrollTo(0,1150))},error:function(){window.buttonLoading(document.querySelector("#btnContinue"),!1,t);$("#customError").val(i.errorMessage);$("#customError").removeClass("hideContent");window.scrollTo(0,1150)}})}function s(n,t,i,r){$.ajax({url:"/Account/CreateAddOnFree/?countryCode="+n+"&customerId="+t+"&membershipPlanId="+i+"&token="+r,beforeSend:function(){},type:"POST",data:null,cache:!1,complete:function(){},success:function(n){n.success?(n.data.id>0&&toastr.success("Membership card created succesfully."),setTimeout(function(){window.location.href="/Account/AccountSummary"},1500)):n.errorMessage!==null&&toastr.error(n.errorMessage)},error:function(n){n.responseText===""?(toastr.success("Membership card created succesfully."),setTimeout(function(){window.location.href="/Account/AccountSummary"},1500)):($("#btnAccountSetup").prop("disabled",!1),toastr.error(n.responseText))}})}function e(n){$.ajax({url:"/Account/CreateAddOn",beforeSend:function(){},type:"POST",data:n.serialize(),cache:!1,complete:function(){},success:function(n){n.success?(n.data.id>0&&toastr.success("Membership card created succesfully."),setTimeout(function(){window.location.href="/Account/AccountSummary"},1500)):n.errorMessage!==null&&($("#btnContinuePayment").prop("disabled",!1),toastr.error(n.errorMessage))},error:function(n){n.responseText===""?(toastr.success("Membership card created succesfully."),setTimeout(function(){window.location.href="/Account/AccountSummary"},1500)):toastr.error(n.responseText)}})}function h(n,t,i,r){window.location.href="/Account/AccountStatement/?country="+countrySelected+"&customerId="+t+"&cardId="+i+"&currentPage="+n+"&accountStatus"+r}function c(){$(".search").hide();$("#myTopnav").hide();$(".mm-dropdown").hide()}function l(n){var t=$("#CustomerId").val();t===""&&(t=null);$.get("/account/RegisterValidation",{code:n,customerId:t},function(n){if(n.success){if(n.data.Name!==""){var r=n.data.cardCost;t!==""&&t!==undefined&&t!==null&&(parseFloat(r).toFixed(2)=="0.00"||parseFloat(r).toFixed(2)==0||parseFloat(r).toFixed(2)==0)?s(countrySelected,parseInt(t),n.data.membershipPlanId,n.data.token):window.location.href=t!==""&&t!==undefined&&t!==null&&r>0?"/Account/SelectPayment/?country="+countrySelected+"&customerId="+parseInt(t)+"&membershipPlanId="+n.data.membershipPlanId+"&token="+n.data.token:"/Account/CreateAccount/?country="+countrySelected+"&membershipPlanId="+n.data.membershipPlanId+"&token="+n.data.token}$("#btnAccountSetup").removeClass("active");$("#btnAccountSetup").prop("disabled",!1)}else $.when(i("The registration code entered is invalid.",n.errorMessage)),$("#btnAccountSetup").removeClass("active"),$("#btnAccountSetup").prop("disabled",!1)})}function a(n){$.get("/account/ValidateDefaultPlan",{customerId:n},function(t){t.success?window.location.href="/Account/SelectPayment/?country="+countrySelected+"&customerId="+parseInt(n)+"&membershipPlanId="+defaultMembershipPlan:($.when(i("Warning!",t.errorMessage)),$("#btnBuyNow").removeClass("active"),$("#btnBuyNow").prop("disabled",!1))})}function o(){var t,u,i;$("#Check").is(":checked")?(t="",n!==null&&n!==undefined?t=n.serialize():(u=$("#btnContinuePayment").closest("form"),t=u.serialize()),i=$("#Id").val(),i===""||i==="0"||i===undefined?$.ajax({url:"/PayPal/PayPalRequest",beforeSend:function(){$("#waitpaypal").show()},type:"POST",data:t,cache:!1,complete:function(){$("#waitpaypal").hide()},success:function(n){n.success?($("#customerPaymentProviderId").val(n.data),r=!0,$("#submitAccountForm").submit()):($("#submitAccountForm").prop("disabled",!1),toastr.error(n.errorMessage))},error:function(n){$("#submitAccountForm").prop("disabled",!1);toastr.error(n.responseText)}}):i!==""&&$.ajax({url:"/PayPal/AddOnPayPalRequest",beforeSend:function(){$("#waitpaypal").show()},type:"POST",data:t,cache:!1,complete:function(){$("#waitpaypal").hide()},success:function(n){n.success?($("#customerPaymentProviderId").val(n.data),r=!0,$("#submitAccountForm").submit()):($("#submitAccountForm").prop("disabled",!1),toastr.error(n.errorMessage))},error:function(n){$("#submitAccountForm").prop("disabled",!1);toastr.error(n.responseText)}})):($("#submitAccountForm").prop("disabled",!1),toastr.error("Please select agree terms and continue"))}function v(n,t){window.location.href="/Account/AccountSummary/?country="+countrySelected+"&customerId="+t+"&cardId="+n}function y(n,t){var i=t,r=$(n);r.each(function(){var n=$(this).text().trim(),t=n.slice(0,i)+"<span class='ellipsis'>&nbsp;<\/span><a href='#' class='more'>Read more<\/a><span style='display:none'>"+n.slice(i,n.length)+"<a href='#' class='less'>Hide<\/a><\/span>";n.length<i||$(this).html(t)});$(".more").click(function(n){n.preventDefault();$(this).hide().prev().hide();$(this).next().show()});$(".less").click(function(n){n.preventDefault();$(this).parent().hide().prev().show().prev().show()})}function p(){y(".planDescDiv",200)}function w(){var n=$("#MembershipPlanId").val();({}).MembershipPlanId=n;$.ajax({url:"/PayPal/PayPalRequestUpgradeAccount",beforeSend:function(){},type:"POST",data:{MembershipPlanId:n},cache:!1,complete:function(){},success:function(n){console.log(n);n.success?($("#customerPaymentProviderId").val(n.data),u=!0,$("#submitOrderPayment").submit()):($("#btnPayPalOrder").prop("disabled",!1),console.log(n.errorMessage))},error:function(n){$("#btnPayPalOrder").prop("disabled",!1);console.log(n.responseText)}})}function b(){var n=!0,f=$("#Forename").val(),e=$("#Surname").val(),i=$("#Email").val(),r=$("#Confirmemail").val(),t=$("#Password").val(),u=$("#ConfirmPassword").val(),s=new RegExp("^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$"),o=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&^#])[A-Za-z\\d@$!%*?&^#]{8,48}$");return f===null||f===undefined||f.trim()===""?(n=!1,$("#Forename").hasClass("--invalid")||$("#Forename").addClass("--invalid")):$("#Forename").removeClass("--invalid"),e===null||e===undefined||e.trim()===""?(n=!1,$("#Surname").hasClass("--invalid")||$("#Surname").addClass("--invalid")):$("#Surname").removeClass("--invalid"),i===null||i===undefined||i.trim()===""?(n=!1,$("#Email").hasClass("--invalid")||$("#Email").addClass("--invalid")):$("#Email").removeClass("--invalid"),r===null||r===undefined||r.trim()===""?(n=!1,$("#Confirmemail").hasClass("--invalid")||$("#Confirmemail").addClass("--invalid")):$("#Confirmemail").removeClass("--invalid"),t===null||t===undefined||t.trim()===""?(n=!1,$("#Password").hasClass("--invalid")||$("#Password").addClass("--invalid")):$("#Password").removeClass("--invalid"),u===null||u===undefined||u.trim()===""?(n=!1,$("#ConfirmPassword").hasClass("--invalid")||$("#ConfirmPassword").addClass("--invalid")):$("#ConfirmPassword").removeClass("--invalid"),i.trim()!==r&&(n=!1,$("#Confirmemail").hasClass("--invalid")||$("#Confirmemail").addClass("--invalid"),$("#Email").hasClass("--invalid")||$("#Email").addClass("--invalid")),t.trim()!==u&&(n=!1,$("#ConfirmPassword").hasClass("--invalid")||$("#ConfirmPassword").addClass("--invalid"),$("#Password").hasClass("--invalid")||$("#Password").addClass("--invalid")),o.test(t)||(n=!1,$("#ConfirmPassword").hasClass("--invalid")||$("#ConfirmPassword").addClass("--invalid"),$("#Password").hasClass("--invalid")||$("#Password").addClass("--invalid")),n}function k(){$("#close_window").on("click",function(){window.close()});$("#btnBuyNow").unbind().click(function(){$(this).toggleClass("active");$(this).prop("disabled",!0);var n=$("#CustomerId").val();n===""?window.location.href="/Account/CreateAccount/?country="+countrySelected+"&membershipPlanId="+defaultMembershipPlan:n!==""&&a(n)});$("#btnAccountSetup").unbind().click(function(n){n.preventDefault();$(this).toggleClass("active");$(this).prop("disabled",!0);var t=$("#registerCode").val();t!==null&&t!==undefined&&t!==""?l(t):(toastr.error("Please enter registration code and continue"),$(this).toggleClass("active"),$(this).prop("disabled",!1))});$("#Tick").is(":checked")?($(".bothcards").show(),$(".singlecard").hide(),$("#hostedbuttonid").val($("#SubscribeAppAndCardRef").val())):($("#Addressone").attr("disabled",!0),$("#Addresstwo").attr("disabled",!0),$("#Addressthree").attr("disabled",!0),$("#Town").attr("disabled",!0),$("#County").attr("disabled",!0),$("#hostedbuttonid").val($("#SubscribeAppRef").val()),$(".bothcards").hide(),$(".singlecard").show());$("#Tick").change(function(n){n.preventDefault();$("#Tick").is(":checked")?($("#Addressone").removeAttr("disabled"),$("#Addresstwo").removeAttr("disabled"),$("#Addressthree").removeAttr("disabled"),$("#Town").removeAttr("disabled"),$("#County").removeAttr("disabled"),$("#hostedbuttonid").val($("#SubscribeAppAndCardRef").val()),$(".bothcards").show(),$(".singlecard").hide()):($("#Addressone").attr("disabled",!0),$("#Addresstwo").attr("disabled",!0),$("#Addressthree").attr("disabled",!0),$("#Town").attr("disabled",!0),$("#County").attr("disabled",!0),$("#hostedbuttonid").val($("#SubscribeAppRef").val()),$(".bothcards").hide(),$(".singlecard").show())});$("#marketing").change(function(n){n.preventDefault();var t=$(this).is(":checked");$("#MarketingPreference").val(t)});$("#btnContinue").unbind().click(function(i){var e,o,r,u;i.preventDefault();t=$("#btnContinue")[0].innerText;window.buttonLoading(document.querySelector("#btnContinue"),!0,"Creating Account");$("#customError").hasClass("hideContent")||$("#customError").addClass("hideContent");$("#msgError").hasClass("hideContent")||$("#msgError").addClass("hideContent");$("#remember").hasClass("--invalid")&&$("#remember").removeClass("--invalid");e=$(this).closest("form");o=b();o?$("#Email").val()!==$("#Confirmemail").val()?(window.buttonLoading(document.querySelector("#btnContinue"),!1,t),$("#msgError").hasClass("hideContent")&&$("#msgError").removeClass("hideContent"),window.scrollTo(0,1150)):$("#Password").val()!==$("#ConfirmPassword").val()?(window.buttonLoading(document.querySelector("#btnContinue"),!1,t),$("#msgError").hasClass("hideContent")&&$("#msgError").removeClass("hideContent"),window.scrollTo(0,1150)):$("#remember").is(":checked")?(r=$("#Token").val(),u=parseFloat($("#CardCost").val()).toFixed(2),r!==null&&r!==undefined&&r!==""&&(u==="0.00"||u===0||u===0)?f(e):(n=e,$(".accountFormDiv").addClass("hidden"),$("#ChoosePaymentScreen").removeClass("hidden"),window.scrollTo(0,1150))):(window.buttonLoading(document.querySelector("#btnContinue"),!1,t),$("#customError").hasClass("hideContent")&&($("#customError").removeClass("hideContent"),$("#customError").html("Please accept Terms and Conditions to continue.")),window.scrollTo(0,1150)):($("#msgError").hasClass("hideContent")&&$("#msgError").removeClass("hideContent"),window.buttonLoading(document.querySelector("#btnContinue"),!1,t),window.scrollTo(0,1150))});$("a, button").click(function(){$(this).toggleClass("active")}),function(n){n.fn.circliful=function(t){var i=n.extend({fgcolor:"#556b2f",bgcolor:"#eee",fill:!1,width:15,dimension:200,fontsize:15,percent:50,animationstep:1,iconsize:"20px",iconcolor:"#999",border:"default",complete:null},t);return this.each(function(){function v(t,i,u){n("<span><\/span>").appendTo(t).addClass(i).text(b).prepend(p).css({"line-height":u+"px","font-size":r.fontsize+"px"})}function y(t,i){n("<span><\/span>").appendTo(t).addClass("circle-info-half").css("line-height",r.dimension*i+"px")}function ht(t){n.each(ft,function(u,f){r[f]=t.data(f)!==undefined?t.data(f):n(i).attr(f);f=="fill"&&t.data("fill")!==undefined&&(w=!0)})}function ut(i){u.clearRect(0,0,o.width,o.height);u.beginPath();u.arc(k,d,g,tt,nt,!1);u.lineWidth=r.width+1;u.strokeStyle=r.bgcolor;u.stroke();w&&(u.fillStyle=r.fill,u.fill());u.beginPath();u.arc(k,d,g,-a,it*i-a,!1);r.border==="outline"?u.lineWidth=r.width+13:r.border==="inline"&&(u.lineWidth=r.width-13);u.strokeStyle=r.fgcolor;u.stroke();h<e&&(h+=st,requestAnimationFrame(function(){ut(Math.min(h,e)/100)},f));h===e&&rt&&typeof t!="undefined"&&n.isFunction(t.complete)&&(t.complete(),rt=!1)}var ft=["fgcolor","bgcolor","fill","width","dimension","fontsize","animationstep","endPercent","icon","iconcolor","iconsize","border"],r={},p="",e=0,f=n(this),w=!1,b,et,c,l;f.addClass("circliful");ht(f);f.data("text")!==undefined&&(b=f.data("text"),f.data("icon")!==undefined&&(p=n("<i><\/i>").addClass("fa "+n(this).data("icon")).css({color:r.iconcolor,"font-size":r.iconsize})),f.data("type")!==undefined?(s=n(this).data("type"),s==="half"?v(f,"circle-text-half",r.dimension/1.45):v(f,"circle-text",r.dimension)):v(f,"circle-text",r.dimension));n(this).data("total")!==undefined&&n(this).data("part")!=undefined?(l=n(this).data("total")/100,c=(n(this).data("part")/l/100).toFixed(3),e=(n(this).data("part")/l).toFixed(3)):n(this).data("percent")!==undefined?(c=n(this).data("percent")/100,e=n(this).data("percent")):c=i.percent/100;n(this).data("info")!==undefined&&(et=n(this).data("info"),n(this).data("type")!==undefined?(s=n(this).data("type"),s==="half"?y(f,.9):y(f,1.25)):y(f,1.25));n(this).width(r.dimension+"px");var o=n("<canvas><\/canvas>").attr({width:r.dimension,height:r.dimension}).appendTo(n(this)).get(0),u=o.getContext("2d"),k=o.width/2,d=o.height/2,ot=r.percent*360,ct=ot*(Math.PI/180),g=o.width/2.5,nt=2.3*Math.PI,tt=0,h=r.animationstep===0?e:0,st=Math.max(r.animationstep,0),it=Math.PI*2,a=Math.PI/2,s="",rt=!0;n(this).data("type")!==undefined&&(s=n(this).data("type"),s==="half"&&(nt=2*Math.PI,tt=3.13,it=Math.PI*1,a=Math.PI/.996));ut(h/100)})}}(jQuery);$(document).ready(function(){$(".pendingCh").circliful();$(".confirmedCh").circliful();$(".receivedCh").circliful()});$("#question-mark-pending").click(function(){$.when(i("Pending Title","Pending Message"))});$("#question-mark-confirmed").click(function(){$.when(i("Confirmed Title"," Confirmed Message"))});$("#question-mark-received").click(function(){$.when(i("Received Title"," Received Message"))});$("input[type=radio][name=PaymentType]").change(function(){this.value==="PayPal"?($("#paypalbutton").show(),$("#btnContinuePayment").hide()):($("#paypalbutton").hide(),$("#btnContinuePayment").show())});$("#btnContinuePayment").unbind().click(function(t){var i,r,u;t.preventDefault();$(this).prop("disabled",!0);$("input[type=radio][name=PaymentType]").prev().length>0?(i=$("input[type=radio][name=PaymentType]:checked").val(),i===undefined||i===""?($(this).prop("disabled",!1),$(this).toggleClass("active"),toastr.error("Please select Payment Option")):$("#Check").is(":checked")?i.trim()==="Cashback"&&(n===undefined?(r=$(this).closest("form"),e(r)):f(n)):($(this).prop("disabled",!1),$(this).toggleClass("active"),toastr.error("Please select agree terms and continue"))):$("#Check").is(":checked")?i.trim()==="Cashback"&&(n===undefined?(u=$(this).closest("form"),e(u)):f(n)):($(this).prop("disabled",!1),$(this).toggleClass("active"),toastr.error("Please select agree terms and continue"))});$("#submitAccountForm").unbind().submit(function(){if($(this).prop("disabled",!0),r)return r=!1,!0;if($("input[type=radio][name=PaymentType]").prev().length>0){var n=$("input[type=radio][name=PaymentType]:checked").val();n===undefined||n===""?($(this).prop("disabled",!1),toastr.error("Please select Payment Option")):o()}else o();return!1});$("#btnback").click(function(){$("#AccountFormDiv").removeClass("hidden");$("#ChoosePaymentScreen").addClass("hidden");$("#btnContinue").toggleClass("active");window.scrollTo(0,0)});$("#btnPaymentback").click(function(n){n.preventDefault();window.history.back()});$("#statementPaging #pager a").each(function(){$(this).unbind().click(function(n){n.preventDefault();var t=$(this).attr("pagenumber"),i=$(this).closest("#CustomerId"),r=$(this).closest("#CardId"),u=$(this).closest("#AccountStatus");h(t,i,r,u)})});$("#CardId").change(function(n){n.preventDefault();var t=$(this).find(":selected").val(),i=$("#CustomerId").val();t!==""&&i!==""&&v(t,i)});$(".paylatercash").hide();$("#submitOrderPayment").unbind().submit(function(){return($("#btnPayPalOrder").prop("disabled",!0),u)?(u=!1,!0):(w(),!1)});$("#diamond-upgrade").unbind().change(function(n){n.preventDefault();$("#diamond-upgrade").is(":checked")?$("#DiamondUpgrade").val(!0):$("#DiamondUpgrade").val(!1)});$("#Postcode").unbind().blur(function(n){n.preventDefault();var i=new RegExp("^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$"),t=$(this).val().toUpperCase();t.length>0&&($(this).val(t),i.test(t)?($("#Postcode").hasClass("--invalid")&&$("#Postcode").removeClass("--invalid"),$("#customError").hasClass("hideContent")||$("#customError").addClass("hideContent")):($("#customError").html("Postcode is invalid."),$("#customError").removeClass("hideContent"),$("#Postcode").hasClass("--invalid")||$("#Postcode").addClass("--invalid")))})}var n,r=!1,u=!1,t="";const g=document.querySelectorAll(".accordion a");return{setUpEvents:k,termsHidden:c,planDescription:p}}(),Banner=function(){"use strict";function i(n){function t(){var f=i.$Elmt.parentNode,n=f.clientWidth,r;n?(r=Math.min(u||n,n),i.$ScaleWidth(r)):window.setTimeout(t,30)}var r={$SlideWidth:154,$SlideHeight:80,$SlideSpacing:35,$ArrowNavigatorOptions:{$Class:$JssorArrowNavigator$}},i=new $JssorSlider$(n,r),u=1920;t();$Jssor$.$AddEvent(window,"load",t);$Jssor$.$AddEvent(window,"resize",t);$Jssor$.$AddEvent(window,"orientationchange",t)}function u(n){function t(){var f=i.$Elmt.parentNode,n=f.clientWidth,r;n?(r=Math.min(u||n,n),i.$ScaleWidth(r)):window.setTimeout(t,30)}var r={$SlideWidth:134,$SlideHeight:80,$SlideSpacing:30,$ArrowNavigatorOptions:{$Class:$JssorArrowNavigator$}},i=new $JssorSlider$(n,r),u=1920;t();$Jssor$.$AddEvent(window,"load",t);$Jssor$.$AddEvent(window,"resize",t);$Jssor$.$AddEvent(window,"orientationchange",t)}function r(n){function t(){var f=i.$Elmt.parentNode,n=f.clientWidth,r;n?(r=Math.min(u||n,n),i.$ScaleWidth(r)):window.setTimeout(t,30)}var r={$SlideWidth:980,$SlideSpacing:0,$ArrowNavigatorOptions:{$Class:$JssorArrowNavigator$}},i=new $JssorSlider$(n,r),u=1920;t();$Jssor$.$AddEvent(window,"load",t);$Jssor$.$AddEvent(window,"resize",t);$Jssor$.$AddEvent(window,"orientationchange",t)}function f(u,f){t=u;n=f;for(var o,e=1;e<u;e++)r("full_width_banner"+e);for(o=1;o<f;o++)i("Slotted_banner"+o)}function e(i,f){t=i;n=f;for(var o,e=1;e<i;e++)r("full_width_banner"+e);for(o=1;o<f;o++)u("Slotted_banner"+o)}function o(){}var n=0,t=0;return{setUpEvents:o,Slotted_banner_slider_init:i,bannerdisplay:f,bannerpagedisplay:e}}(),Login=function(){"use strict";function t(t,i){var r="";n=$("#btnLogin")[0].innerText;window.buttonLoading(document.querySelector("#btnLogin"),!0,"Logging in...");t!==null&&(r=t.serialize());$.ajax({url:"/Account/Login",beforeSend:function(){},type:"POST",data:r,cache:!1,complete:function(){},success:function(t){t.success?i?window.location.href="/OfferHub/":window.location.reload():($("#btnLogin").prop("disabled",!1),window.buttonLoading(document.querySelector("#btnLogin"),!1,n),$("#loginError").text(t.errorMessage),$("#loginError").show())},error:function(t){$("#btnLogin").prop("disabled",!1);window.buttonLoading(document.querySelector("#btnLogin"),!1,n);$("#loginError").text(t.responseText);$("#loginError").show()}})}function i(t){n=$("#btnAccountSetup")[0].innerText;window.buttonLoading(document.querySelector("#btnAccountSetup"),!0,"Loading...");var i=$("#CustomerId").val();i===""&&(i=null);$.get("/account/RegisterValidation",{code:t,customerId:i},function(t){if(t.success){if(t.data.Name!==""){var r=t.data.cardCost;i!==""&&i!==undefined&&i!==null&&(parseFloat(r).toFixed(2)=="0.00"||parseFloat(r).toFixed(2)==0||parseFloat(r).toFixed(2)==0)?createAddOnFree(countrySelected,parseInt(i),t.data.membershipPlanId,t.data.token):window.location.href=i!==""&&i!==undefined&&i!==null&&r>0?"/Account/SelectPayment/?country="+countrySelected+"&customerId="+parseInt(i)+"&membershipPlanId="+t.data.membershipPlanId+"&token="+t.data.token:t.data.slug==="sport-rewards"?"/SportRewards/Index":"/Account/CreateAccount"}window.buttonLoading(document.querySelector("#btnAccountSetup"),!1,n)}else $("#AccountErrorMessage").text(t.errorMessage),$("#AccountErrorMessage").show(),$("#btnAccountSetup").prop("disabled",!1),window.buttonLoading(document.querySelector("#btnAccountSetup"),!1,n)})}function r(){$(document).keypress(function(n){(n.which==13||event.keyCode==13)&&(n.preventDefault(),$("#btnLogin").click())});$("#btnLogin").unbind().click(function(n){var r,i,u;n.preventDefault();$(this).prop("disabled",!0);$("#loginError").hide();r=!1;r=$(this).attr("offerHubRedirect")===null||$(this).attr("offerHubRedirect")===undefined?!1:$(this).attr("offerHubRedirect")==="true";i=$(this).closest("form");i.validate({rules:{Username:{required:!0,email:!0},LoginPassword:"required"},messages:{Username:"",LoginPassword:""},submitHandler:function(n){n.submit()}});u=i.valid();u?t(i,r):$(this).prop("disabled",!1)});$("#ForgotPassword").unbind().click(function(n){var t,i;n.preventDefault();$(this).prop("disabled",!0);$("#errorNoticeMessage").hide();$("#successNoticeMessage").hide();t=$(this).closest("form");t.validate({rules:{Username:{required:!0}},messages:{Username:""},submitHandler:function(n){n.submit()}});i=t.valid();i?$.ajax({url:"/Account/ResetPasswordEmail?username="+$("#Username").val().trim(),beforeSend:function(){},type:"POST",data:null,cache:!1,complete:function(){},success:function(n){$("#ForgotPassword").prop("disabled",!1);n.success?($("#successNoticeMessage").text(n.data),$("#successNoticeMessage").show()):($("#errorNoticeMessage").text(n.errorMessage),$("#errorNoticeMessage").show())},error:function(n){$("#errorNoticeMessage").text(n.responseText);$("#errorNoticeMessage").show();$("#ForgotPassword").prop("disabled",!1)}}):$(this).prop("disabled",!1)});$("#btnAccountSetup").unbind().click(function(n){var t,r,u;n.preventDefault();$(this).prop("disabled",!0);$("#AccountErrorMessage").hide();t=$(this).closest("form");t.validate({rules:{registerCode:{required:!0}},messages:{registerCode:""},submitHandler:function(n){n.submit()}});r=t.valid();u=$("#RegistrationUrl").val();r?i($("#registerCode").val().trim()):r||u==null?$(this).prop("disabled",!1):location.href=u});$("#SubmitPassword").unbind().click(function(n){n.preventDefault();$(this).prop("disabled",!0);$("#ErrorMsg").hasClass("hideContent")||$("#ErrorMsg").addClass("hideContent");var u=$("#Username").val(),t=$("#NewPassword").val(),r=$("#ConfirmPassword").val(),f=$("#Token").val(),i=!0,e=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&^#])[A-Za-z\\d@$!%*?&^#]{8,48}$");(t===null||t===undefined||t.trim()==="")&&(i=!1,$("#ErrorMsg").val("The password entered does not follow the rules. Please enter a password as described below and then try again."),$("#NewPassword").addClass("--invalid"));(r===null||r===undefined||r.trim()==="")&&(i=!1,$("#ErrorMsg").val("The passwords entered do not match. Please enter the confirmation password again."),$("#ConfirmPassword").addClass("--invalid"));t!==r&&(i=!1);e.test(t)||(i=!1,$("#ErrorMsg").val("The password entered does not follow the rules. Please enter a password as described below and then try again."),$("#ConfirmPassword").hasClass("--invalid")||$("#ConfirmPassword").addClass("--invalid"),$("#Password").hasClass("--invalid")||$("#Password").addClass("--invalid"));i?$.ajax({url:"/Account/SaveNewPassword?username="+u+"&token="+f+"&password="+t,beforeSend:function(){$(".spinner").show()},type:"Post",data:null,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#successMsg").hasClass("hideContent")&&$("#successMsg").removeClass("hideContent"),$("#ErrorMsg").hasClass("hideContent")||$("#ErrorMsg").addClass("hideContent"),setTimeout(function(){window.location.href="/Home"},1500)):($("#ErrorMsg").html("An error occurred attempting to reset your password. Please try again."),$("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent"),$("#SubmitPassword").prop("disabled",!1))},error:function(){$("#ErrorMsg").html("An error occurred attempting to reset your password. Please try again.");$("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent");$("#SubmitPassword").prop("disabled",!1)}}):($("#ErrorMsg").removeClass("hideContent"),$("#SubmitPassword").prop("disabled",!1))});$("#NewPassword, #ConfirmPassword").keyup(u)}function u(){var n=$("#NewPassword").val(),t=$("#ConfirmPassword").val(),i=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&^#])[A-Za-z\\d@$!%*?&^#]{8,48}$");$("#ConfirmPassword").is(":focus")&&!i.test(n)?($("#ErrorMsg").html("The password entered does not follow the rules. Please enter a password as described below and then try again."),$("#NewPassword").addClass("--invalid"),$("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent")):t!==null&&t!==undefined&&t.trim()!==""&&n!==t?($("#ErrorMsg").html("The passwords entered do not match. Please enter the confirmation password again."),$("#NewPassword").removeClass("--invalid"),$("#ConfirmPassword").addClass("--invalid"),$("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent")):n===null||n===undefined||n.trim()===""?($("#ErrorMsg").html("The password entered does not follow the rules. Please enter a password as described below and then try again."),$("#NewPassword").addClass("--invalid"),$("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent")):($("#NewPassword").removeClass("--invalid"),$("#ConfirmPassword").removeClass("--invalid"),$("#ErrorMsg").hasClass("hideContent")||$("#ErrorMsg").addClass("hideContent"))}var n="";return{setUpEvents:r}}(),Offers=function(){"use strict";function i(n,t){var i=$.Deferred();return $("#infoMessage").html(t),$("#dialog-confirm").dialog({title:n,draggable:!1,autoResize:!0,resizable:!1,open:function(){var n=$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close");n.hide()},modal:!0,buttons:{Close:{id:"btnYesId",text:"Close",click:function(){$("#infoMessage").html("");$(this).dialog("close");i.resolve("Yes")},"class":"btnYes"}}}),i.promise()}function r(t){var i="/Offers/DisplayOffer?country="+countrySelected+"&parentCategoryId="+$("#ParentCategoryId").val()+"&parentCategoryName="+$("#ParentCategoryName").val().replace(/&/,"%26"),f="",r="";$("#displaySidebarFilter input[name='searchCategories']:checked").each(function(){f=f+$(this).attr("id")+","});f.length>0&&(f=f.substring(0,f.length-1),i=i+"&searchCategories="+f);$("#displaySidebarFilter input[name='offer-type']:checked").each(function(){$.trim($(this).val())==="Cashback"&&(r=r+"Standard Cashback,");r=r+$(this).val()+","});r.length>0&&(r=r.substring(0,r.length-1),i=i+"&searchOfferTypes="+r);$("#displaySidebarFilter input[name='MerchantName']").val()!==null&&$("#displaySidebarFilter input[name='MerchantName']").val()!==""&&$("#displaySidebarFilter input[name='MerchantName']").val()!==undefined&&u($("#displaySidebarFilter input[name='MerchantName']").val());n!==null&&n!==""&&n!==undefined&&(n=n.replace("amp;",""),i=i+"&merchant="+encodeURIComponent(n));i=i+"&pageNumber="+t;$("#offerCount").val()!==undefined&&$("#offerCount").val()!==null&&(i=i+"&pageSize="+$("#offerCount").val());$("#offerSort").val()!==undefined&&$("#offerSort").val()!==null&&(i=i+"&offerSort="+$("#offerSort").val());window.location.href=i}function t(t){var i="/Offers/SearchByText?country="+countrySelected,u="",r="";$("#searchSidebarFilter input[name='searchCategories']:checked").each(function(){u=u+$(this).attr("id")+","});u.length>0&&(u=u.substring(0,u.length-1),i=i+"&searchCategories="+u);$("#searchSidebarFilter input[name='offer-type']:checked").each(function(){$.trim($(this).val())==="Cashback"&&(r=r+"Standard Cashback,");r=r+$(this).val()+","});r.length>0&&(r=r.substring(0,r.length-1),i=i+"&searchOfferTypes="+r);$("#offerCount").val()!==undefined&&$("#offerCount").val()!==null&&(i=i+"&pageSize="+$("#offerCount").val());$("#offerSort").val()!==undefined&&$("#offerSort").val()!==null&&(i=i+"&offerSort="+$("#offerSort").val());n!==null&&n!==""&&n!==undefined&&(n=n.replace("amp;",""));i=i+"&pageNumber="+t+"&mainSearchTerm="+encodeURIComponent(n);window.location.href=i}function u(t){var f=t,u=t,r,i;document.getElementById("scriptedWrite").innerText+=f;r=document.createElement("div");r.textContent=u;document.body.appendChild(r);i=document.createElement("div");i.appendChild(document.createTextNode(u));document.body.appendChild(i);n=i.innerHTML}function y(n,t){$.ajax({url:"/Offers/GetPagedBranchContact?merchantId="+t+"&currentPage="+n,beforeSend:function(){},type:"GET",contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n?($(".merchtbranchfnt").html(n),f(),l(".rdfull",50)):toastr.error(n)},error:function(n){toastr.error(n.responseText)}})}function p(){$("html, body").animate({scrollTop:$(".newmerchbck").offset().top},500)}function l(n,t){var i=t,r=$(n);r.each(function(){var n=$(this).text().trim(),t=n.slice(0,i)+"<span class='ellipsis'>&nbsp;<\/span><a href='#' class='more'>Read more<\/a><span style='display:none'>"+n.slice(i,n.length)+"<a href='#' class='less'>Hide<\/a><\/span>";n.length<i||$(this).html(t)});$(".more").click(function(n){n.preventDefault();$(this).hide().prev().hide();$(this).next().show()});$(".less").click(function(n){n.preventDefault();$(this).parent().hide().prev().show().prev().show()})}function b(){this.classList.toggle("active");this.nextElementSibling.classList.toggle("active")}function k(){var n=!0,i=$("#Address1").val(),t=$("#Postcode").val(),r=$("#Town").val(),u=$("#Country").val(),f=new RegExp("^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$");return i===null||i===undefined||i.trim()===""?(n=!1,$("#Address1").hasClass("--invalid")||$("#Address1").addClass("--invalid")):$("#Address1").removeClass("--invalid"),r===null||r===undefined||r.trim()===""?(n=!1,$("#Town").hasClass("--invalid")||$("#Town").addClass("--invalid")):$("#Town").removeClass("--invalid"),u===null||u===undefined||u.trim()===""?(n=!1,$("#Country").hasClass("--invalid")||$("#Country").addClass("--invalid")):$("#Country").removeClass("--invalid"),t===null||t===undefined||t.trim()===""?(n=!1,$("#Postcode").hasClass("--invalid")||$("#Postcode").addClass("--invalid")):$("#Postcode").removeClass("--invalid"),f.test(t)||(n=!1,$("#Postcode").hasClass("--invalid")||$("#Postcode").addClass("--invalid")),n}function f(){$("#searchSidebarFilter #btnApply").unbind().click(function(n){n.preventDefault();$(this).prop("disabled",!0);t(1)});$("#searchContentFilter #offerCount").on("change",function(){t(1)});$("#searchContentFilter #offerSort").on("change",function(){t(1)});$("#searchContentFilter .c_pagination a").each(function(){$(this).unbind().click(function(n){var i,r;n.preventDefault();i=$(this).attr("pageNumber");i!=="0"&&($("input[name='mainSearchTerm']").val()!==""?(r=$("input[name='mainSearchTerm']").val(),u(r),t(i)):window.location.href="/Home/Index?country="+countrySelected)})});$("#displaySidebarFilter #btnApply").unbind().click(function(n){n.preventDefault();$(this).prop("disabled",!0);r(1)});$("#displayContentFilter #offerCount").on("change",function(){r(1)});$("#displayContentFilter #offerSort").on("change",function(){r(1)});$("#displayContentFilter .c_pagination a").each(function(){$(this).unbind().click(function(n){n.preventDefault();var t=$(this).attr("pageNumber");t!=="0"&&r(t)})});$(".merchtbranchfnt #pager a").each(function(){$(this).unbind().click(function(n){n.preventDefault();var t=$(this).attr("pagenumber"),i=$(".merchtbranchfnt").attr("MerchantId");y(t,i);p()})});$(".termpop").unbind().click(function(n){n.preventDefault();$(this).addClass("visitlink");var t=$(this).children("#Terms")[0].value;t!==null&&t!==""&&$.when(i("Terms",t))});$(".inspop").unbind().click(function(n){n.preventDefault();$(this).addClass("visitlink");var t=$(this).children("#Instructions")[0].value;t!=null&&t!=""&&$.when(i("Instructions",t))});$(".exlpop").unbind().click(function(n){n.preventDefault();$(this).addClass("visitlink");var t=$(this).children("#Exclusions")[0].value;t!=null&&t!=""&&$.when(i("Exculsion",t))});$(".codepop").unbind().click(function(n){n.preventDefault();var t=$(this).children("#Code")[0].value;t!=null&&t!=""&&$.when(i("Get Code",t))});$("a, button").click(function(){$(this).toggleClass("active")});$(".category").unbind().click(function(n){n.preventDefault();var t=$(this).text();window.location.href="/Offers/DisplayOffer/?country="+countrySelected+"&searchCategories="+encodeURIComponent(t)});$(".btn-cashback").unbind().click(function(n){n.preventDefault();var t=$(this).attr("merchantId");window.location.href="/Offers/Index/?country="+countrySelected+"&merchantId="+t});$(".btnDetailCashback").unbind().click(function(n){var t,i;n.preventDefault();t=$(this).attr("linkurl");userSignedIn&&t==="1"?(i=$(this).attr("offerId"),$('<a href="/Offers/Redirect/?country='+countrySelected+"&offerId="+i+'" target="_blank"><\/a>')[0].click()):userSignedIn?t==="0"&&toastr.error("Merchant url missing."):toastr.error("Please Login/Signup to continue.")});$(".btnStandardCashback").unbind().click(function(n){var t,i;n.preventDefault();t=$("#Standard_0__DeepLinkAvailable").val();userSignedIn&&t.toLowerCase()==="true"?(i=$(this).attr("offerId"),$('<a href="/Offers/Redirect/?country='+countrySelected+"&offerId="+i+'" target="_blank"><\/a>')[0].click()):userSignedIn?t.toLowerCase()==="false"&&toastr.error("Merchant url missing."):toastr.error("Please Login/Signup to continue.")});$("#btnShop").unbind().click(function(n){var i,t;n.preventDefault();$("#btnShop").prop("disabled",!0);i=k();i?(t=new FormData,t.append("Id",$("#Id").val()),t.append("UserId",$("#UserId").val()),t.append("MembershipCardId",$("#MembershipCardId").val()),t.append("OfferId",$("#OfferId").val()),t.append("Address1",$("#Address1").val()),t.append("Address2",$("#Address2").val()),t.append("Address3",$("#Address3").val()),t.append("Town",$("#Town").val()),t.append("County",$("#County").val()),t.append("Postcode",$("#Postcode").val()),t.append("Country",$("#Country").val()),$.ajax({url:"/Offers/RedeemOffer",beforeSend:function(){$(".spinner").show()},type:"Post",data:t,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#successRedeem").html("Congratulations, your Love2Shop card will be posted to you shortly."),$("#successRedeem").focus(),$("#successRedeem").hasClass("hideContent")&&$("#successRedeem").removeClass("hideContent"),$("#errorRedeem").hasClass("hideContent")||$("#errorRedeem").addClass("hideContent"),window.location.href="/Offers/RedeemSuccess"):($("#errorRedeem").html("Error redeeming the offer."),$("#errorRedeem").hasClass("hideContent")&&$("#errorRedeem").removeClass("hideContent"),$("#btnShop").prop("disabled",!1),window.location.href="/Offers/RedeemFail")},error:function(){$("#errorRedeem").html("Error redeeming the offer.");$("#errorRedeem").focus();$("#errorRedeem").hasClass("hideContent")&&$("#errorRedeem").removeClass("hideContent");$("#btnShop").prop("disabled",!1);window.location.href="/Offers/RedeemFail"}})):($("#errorRedeem").hasClass("hideContent")&&$("#errorRedeem").removeClass("hideContent"),$("#btnShop").prop("disabled",!1))})}function d(n){$.ajax({url:"/Offers/ShortSearch?country="+countrySelected+"&searchTerm="+n,beforeSend:function(){},type:"GET",cache:!1,complete:function(){},success:function(n){var t,r,i;if(n.success){if(n.data!==null){t=n.data[0].merchantName;n.data.offerShortDescription!==null&&n.data.offerShortDescription!==undefined&&(t=t+" - "+n.data.offerShortDescription.trim());r='<select><option value="'+t+'" merchant='+n.data[0].merchantId+" offer="+n.data[0].offerId+"><\/option><\/select>";$("#merchants").html(r);var e=document.querySelector("datalist"),u=document.querySelector("select"),f=u.options;if(e.style.display==="")for(i=0;i<f.length;i++)if(f[i].value.trim()==t){u.selectedIndex=i;$("input[name='mainSearchTerm']").trigger("keydown");break}}}else alert("Some error occurred. Please try again.")},error:function(n){alert(n.responseText)}})}var s,e,h,n,c=[],o=!1;$("#btnmainSearchTerm").unbind().click(function(){var n=$("input[name='mainSearchTerm']").val();return u(n),t(1),!1});$("input[name='mainSearchTerms']").keypress(function(n){if(n.which===10||n.which===13){var i=$("input[name='mainSearchTerms']").val();return u(i),t(1),!1}});const w=document.querySelectorAll(".accordion a");return w.forEach(n=>n.addEventListener("click",b)),{setUpEvents:f,shortSearch:d}}(),Payment=function(){"use strict";function n(n){console.log(n);$.ajax({url:"/PayPal/PayPalAccountRegister",beforeSend:function(){},type:"POST",data:{customerPaymentId:n},cache:!1,complete:function(){},success:function(n){console.log(n);n.success?($("#processingPayment").hide(),$("#paymentSuccessMessage").show()):console.log(n)},error:function(n){toastr.error(n.responseText)}})}return{setUpEvents:n}}(),Summary=function(){"use strict";function h(){var n=$("#MembershipPlanId").val();({}).MembershipPlanId=n;$.ajax({url:"/PayPal/PayPalRequestUpgradeAccount",beforeSend:function(){},type:"POST",data:{MembershipPlanId:n},cache:!1,complete:function(){},success:function(n){console.log(n);n.success?($("#customerPaymentProviderId").val(n.data),f=!0,$("#submitOrderPayment").submit()):$("#btnPayPalOrder").prop("disabled",!1)},error:function(){$("#btnPayPalOrder").prop("disabled",!1)}})}function u(t){var f=$("#MembershipCardId").val(),e=$("#MembershipPlanType").val(),u="Account Overview";n==="Account Overview"||n==="T_Account Overview"?u="Transactions/?page="+t+"&sortField="+r+"&sortDirection="+i+"&membershipPlanType="+e:n==="Withdraw Funds"||n==="T_Withdraw Funds"?u="Withdraw/?country="+countrySelected+"&membershipCardId="+f+"&membershipPlanType="+e:n==="Preferences"||n==="T_Preferences"?u="Account/?membershipCardId="+f:n==="Help"||n==="T_Help"?u="Help":n==="TAM Dashboard"||n==="T_TAM Dashboard"?u="Dashboard?country="+countrySelected+"&membershipCardId="+f:n==="Account"||n==="T_Account"?u="Account/?membershipCardId="+f:n==="Account Package"||n==="T_Account Package"?u="Package/":(n==="Settings"||n==="T_Settings")&&(u="Settings/");$.ajax({url:"/MyAccount/"+u,beforeSend:function(){},type:"GET",cache:!1,complete:function(){},success:function(t){if(t!==null){if($("#divTransactions").html(t),n==="Account Overview"?($("#bannerHeader").css("display","block"),$("#divWithdrawals").css("display","block")):($("#bannerHeader").css("display","none"),$("#divWithdrawals").css("display","none")),n==="Withdraw Funds"){var r=parseFloat($("#AvailableFund").val()),i=$("#RequestExists").val();r===0&&$("#btnWithdraw").attr("disabled",!0);(i==="True"||i==="true")&&($("#btnWithdraw").attr("disabled",!0),$("#successMsg").removeClass("hideContent"),$("#successMsg").html("Withdrawal request is in Processing. Cannot create new request."));$("#error-name").hide();$("#error-number").hide();$("#error-sortcode").hide();$("#error-password").hide();$("#error-validSortCode").hide()}}else alert("Some error occurred. Please try again.");s()},error:function(n){alert(n.responseText)}})}function c(){var n=new FormData,r=$("#CustomerId").val(),u=$("#BankDetailId").val(),f=$("#PartnerRewardId").val(),i=$("#withdrawal_amount").val(),e=$("#Name").val(),o=$("#AccountNumber").val(),s=$("#SortCode").val(),h=$("#Password").val(),c=$("#MembershipPlanType").val(),l=$("#AvailableFund").val();if(l>=5)$("#ErrorMsg").addClass("hideContent");else return $("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent"),$("#ErrorMsg").html("The minimum amount that can be withdrawn is £5.00"),!1;if(!(i>=5))return $("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent"),$("#ErrorMsg").html("The minimum amount that can be withdrawn is £5.00"),!1;n.append("CustomerId",r);n.append("BankDetailId",u);n.append("PartnerRewardId",f);n.append("WithdrawAmount",i);n.append("Name",e);n.append("AccountNumber",o);n.append("SortCode",s);n.append("Password",h);n.append("MembershipPlanType",c);$.ajax({url:"/MyAccount/RequestWithdrawal",beforeSend:function(){$(".spinner").show()},type:"Post",data:n,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#successMsg").removeClass("hideContent"),$("#ErrorMsg").hasClass("hideContent")||$("#ErrorMsg").addClass("hideContent"),$("#divWithdrawalForm").hide()):($("#successMsg").hasClass("hideContent")||$("#successMsg").addClass("hideContent"),$("#ErrorMsg").hasClass("hideContent")&&$("#ErrorMsg").removeClass("hideContent"),window.buttonLoading(document.querySelector("#btnWithdraw"),!1,t))},error:function(){$(".spinner").hide();window.buttonLoading(document.querySelector("#btnWithdraw"),!1,t)}})}function e(){$.ajax({url:"/Account/ResendConfirmation",beforeSend:function(){$(".spinner").show()},type:"Post",data:null,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#confirmEmailSent").removeClass("hideContent"),$("#confirmEmailMsg").hasClass("hideContent")||$("#confirmEmailMsg").addClass("hideContent"),$("#resend").css("display","none")):($("#confirmEmailMsg").hasClass("hideContent")||$("#confirmEmailMsg").addClass("hideContent"),$("#confirmEmailSent").hasClass("hideContent")&&$("#confirmEmailSent").removeClass("hideContent"))},error:function(){$(".spinner").hide()}})}function l(){var t=!0,i=$("#Name").val(),r=$("#AccountNumber").val(),n=$("#SortCode").val(),u=$("#Password").val(),f,e,s;return i===undefined||i===null||i.trim()===""?($("#Name").addClass("--invalid"),t=!1):$("#Name").removeClass("--invalid"),r===undefined||r===null||r.trim()===""?($("#AccountNumber").addClass("--invalid"),t=!1):$("#AccountNumber").removeClass("--invalid"),n===undefined||n===null||n.trim()===""?($("#SortCode").addClass("--invalid"),t=!1):$("#SortCode").removeClass("--invalid"),u===undefined||u===null||u.trim()===""?($("#Password").addClass("--invalid"),t=!1):$("#Password").removeClass("--invalid"),f=$("#withdrawal_amount").val(),e=$("#AvailableFund").val(),parseFloat(f)>parseFloat(e)?($("#withdrawal_amount").addClass("--invalid"),t=!1):$("#withdrawal_amount").removeClass("--invalid"),n!==null&&n!==undefined&&n.trim()===""&&n.length>0&&(n.removeClass("--invalid"),n.length===6&&(s=o(i,2).join("-"),$("#SortCode").val(s)),/^(?!(?:0{6}|00-00-00))(?:\d{6}|\d\d-\d\d-\d\d)$/.test(n)||(t=!1,$("#SortCode").addClass("--invalid"),$("#error-validSortCode").show())),t}function o(n,t){for(var r=[],i=0,u=n.length;i<u;i+=t)r.push(n.substr(i,t));return r}function s(){$("a, button").click(function(){$(this).toggleClass("active")});$("._link").unbind().click(function(t){t.preventDefault();$.each($("._link"),function(){$("a").removeClass("--active")});$(this).addClass("--active");n=$(this)[0].text;n==="Settings"&&$.each($("._sub-link"),function(n,t){t.innerText==="Account"&&$(t).addClass("--active")});n==="Account Overview"||n==="T_Account Overview"?window.location.href="/MyAccount/MyAccount?country="+countrySelected+"&page=1&sortField="+r+"&sortDirection="+i:n==="TAM Dashboard"?window.location.href="/MyAccount/Dashboard?country="+countrySelected:n==="Resend Confirmation Email"||n==="T_Resend Confirmation Email"?e():n==="Account Boost"||n==="T_Account Boost"?window.location.href="/MyAccount/Deposit?country="+countrySelected:n==="Withdraw Funds"||n==="T_Withdraw Funds"?window.location.href="/MyAccount/Withdraw?country="+countrySelected:n==="Account Package"||n==="T_Account Package"?window.location.href="/MyAccount/Package?country="+countrySelected:n==="Settings"||n==="T_Settings"?window.location.href="/MyAccount/Settings/?country="+countrySelected:n!=="Logout"&&u(1)});$("._sub-link").unbind().click(function(t){t.preventDefault();$.each($("._sub-link"),function(){$("a").removeClass("--active")});$(this).addClass("--active");n=$(this).context.innerText;var i=$(this).parent().parent().parent()[0].firstElementChild;$(i).addClass("--active");u(1)});$("#divTransactions #pager a").each(function(){$(this).click(function(t){t.preventDefault();r=$("#SortField").val();i=$("#SortDirection").val();var u=$(this).attr("pagenumber");n="Transactions";window.location.href="/MyAccount/MyAccount?country="+countrySelected+"&page="+u+"&sortField="+r+"&sortDirection="+i})});$(".transactionHeading").each(function(){$(this).click(function(t){t.preventDefault();r=this.childNodes[0].attributes.SelSortField.value;i=$("#SortField").val()===r?$("#SortDirection").val()==="asc"?"desc":"asc":"asc";n="Transactions";u(1)})});$("#btnLogout").unbind().click(function(n){n.preventDefault();$.get("/Account/Logout","",function(n){n.success?window.location.href="/home":toastr.error(n.errorMessage)})});$("#btnWithdraw").unbind().click(function(n){var f,e;n.preventDefault();t=$("#btnWithdraw")[0].innerText;window.buttonLoading(document.querySelector("#btnWithdraw"),!0,"Submitting Request...");var r=l(),i=$("#withdrawal_amount").val(),u=$("#AvailableFund").val();i!==null&&i!==undefined&&u!==null&&u!==undefined&&(f=parseFloat(i).toFixed(2),e=parseFloat(u).toFixed(2),parseFloat(f)>parseFloat(e)&&($("#withdrawal_amount").addClass("--invalid"),$("#ErrorMsg").removeClass("hideContent"),r=!1,window.buttonLoading(document.querySelector("#btnWithdraw"),!1,t)));(i===undefined||i===null||parseFloat(i)===0)&&($("#withdrawal_amount").addClass("--invalid"),$("#ErrorMsg").removeClass("hideContent"),r=!1,window.buttonLoading(document.querySelector("#btnWithdraw"),!1,t));r===!0?(c(),window.buttonLoading(document.querySelector("#btnWithdraw"),!1,t)):window.buttonLoading(document.querySelector("#btnWithdraw"),!1,t);window.scrollTo(0,100)});$("#Name").unbind().change(function(n){n.preventDefault();var t=$(this).val();t.length>0?($(this).removeClass("border-red"),$("#error-name").hide()):($(this).addClass("border-red"),$("#error-name").show())});$("#AccountNumber").unbind().change(function(n){n.preventDefault();var t=$(this).val();t.length>0?($(this).removeClass("border-red"),$("#error-number").hide()):($(this).addClass("border-red"),$("#error-number").show())});$("#SortCode").change(function(n){var i,t,r;n.preventDefault();i=/^(?!(?:0{6}|00-00-00))(?:\d{6}|\d\d-\d\d-\d\d)$/;t=$(this).val();t.length>0?($(this).removeClass("--invalid"),$("#ErrorMsg").addClass("hideContent"),t.length===6&&(r=o(t,2).join("-"),$(this).val(r)),i.test(t)||($(this).addClass("--invalid"),$("#ErrorMsg").removeClass("hideContent"))):($(this).addClass("--invalid"),$("#ErrorMsg").removeClass("hideContent"))});$("#Password").unbind().change(function(n){n.preventDefault();var t=$(this).val();t.length>0?($(this).removeClass("border-red"),$("#error-password").hide()):($(this).addClass("border-red"),$("#error-password").show())});$("#withdrawal_amount").change(function(n){n.preventDefault();var t=$(this).val(),i=$("#AvailableFund").val();parseFloat(t)>parseFloat(i)?($("#withdrawal_amount").addClass("-invalid"),$("#ErrorMsg").removeClass("hideContent")):t!==null&&t!==""&&($("#withdrawal_amount").hasClass("--invalid")&&$("#withdrawal_amount").removeClass("--invalid"),$("#ErrorMsg").hasClass("hideContent")||$("#ErrorMsg").addClass("hideContent"))});$("#personal").unbind().click(function(n){var s,u,h,o;n.preventDefault();t=$("#personal")[0].innerText;window.buttonLoading(document.querySelector("#personal"),!0,"Submitting form...");var i=new FormData,f=!0,e=$("#NationalInsuranceNumber").val(),r="";e!==null&&e!==undefined&&e!==""&&(r=e.replace(/ /g,""),s=new RegExp("^[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}[0-9]{6}[A-D]{0,1}$"),s.test(r)||($("#personalError").html("National insurance number is invalid."),$("#NationalInsuranceNumber").focus(),$("#personalError").removeClass("hideContent"),f=!1,window.buttonLoading(document.querySelector("#personal"),!1,t)));u=$("#postcode").val();h=new RegExp("^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$");u===null||u===undefined||u.trim()===""?(f=!1,$("#postcode").hasClass("--invalid")||$("#postcode").addClass("--invalid")):$("#postcode").removeClass("--invalid");h.test(u)||(f=!1,$("#postcode").hasClass("--invalid")||$("#postcode").addClass("--invalid"));o=!1;$("#marketing").is(":checked")==!0&&(o=!0);f?(i.append("CustomerId",$("#CustomerId").val()),i.append("ContactDetailId",$("#ContactDetailId").val()),i.append("Forename",$("#full_name").val()),i.append("Surname",$("#sur_name").val()),i.append("Email",$("#email").val()),i.append("DateOfBirth",$("#DateOfBirth").val()),i.append("Postcode",$("#postcode").val()),i.append("NationalInsuranceNumber",r),i.append("Address1",$("#Address1").val()),i.append("Address2",$("#Address2").val()),i.append("Address3",$("#Address3").val()),i.append("District",$("#District").val()),i.append("Town",$("#Town").val()),i.append("MarketingNewsLetter",o),$.ajax({url:"/MyAccount/Update",beforeSend:function(){$(".spinner").show()},type:"Post",data:i,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#personalSuccess").html("Personal details updated successfully."),$("#personalSuccess").focus(),$("#personalSuccess").hasClass("hideContent")&&$("#personalSuccess").removeClass("hideContent"),$("#personalError").hasClass("hideContent")||$("#personalError").addClass("hideContent"),window.buttonLoading(document.querySelector("#personal"),!1,t),r!==null&&r!==undefined&&r!==""&&$("#niNNumber").addClass("--met")):($("#personalError").html(n.errorMessage),$("#personalError").focus(),$("#personalError").hasClass("hideContent")&&$("#personalError").removeClass("hideContent"),window.buttonLoading(document.querySelector("#personal"),!1,t));window.scrollTo(0,100)},error:function(){$("#personalError").html(data.errorMessage);$("#personalError").focus();$("#personalError").hasClass("hideContent")&&$("#personalError").removeClass("hideContent");$("#personal").prop("disabled",!1);window.scrollTo(0,100)}})):window.buttonLoading(document.querySelector("#personal"),!1,t)});$("#password").unbind().click(function(n){var s;n.preventDefault();t=$("#password")[0].innerText;window.buttonLoading(document.querySelector("#password"),!0,"Submitting form...");var f=new FormData,r=!0,i="",e=$("#CurrentPassword").val(),u=$("#NewPassword").val(),o=$("#ConfirmPassword").val();(e===null||e===undefined||e==="")&&(i="Current password is required.",r=!1);(u===null||u===undefined||u==="")&&(i.length>0?i+="<br />New password is required":i="New password is required.",r=!1);(o===null||o===undefined||o==="")&&(i.length>0?i+="<br />Confirm password is required":i="Confirm password is required.",r=!1);s=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&^#])[A-Za-z\\d@$!%*?&^#]{8,48}$");s.test(u)||(r=!1,$("#ConfirmPassword").hasClass("--invalid")||$("#ConfirmPassword").addClass("--invalid"),$("#Password").hasClass("--invalid")||$("#Password").addClass("--invalid"));r?(f.append("CurrentPassword",e),f.append("NewPassword",u),f.append("ConfirmPassword",o),$.ajax({url:"/MyAccount/UpdatePassword",beforeSend:function(){$(".spinner").show()},type:"Post",data:f,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#passwordSuccess").html("Password changed successfully."),$("#passwordSuccess").focus(),$("#passwordSuccess").hasClass("hideContent")&&$("#passwordSuccess").removeClass("hideContent"),$("#passwordError").hasClass("hideContent")||$("#passwordError").addClass("hideContent")):($("#passwordError").html(n.errorMessage),$("#passwordError").hasClass("hideContent")&&$("#passwordError").removeClass("hideContent"));window.buttonLoading(document.querySelector("#password"),!1,t)},error:function(){$("#passwordError").html(data.errorMessage);$("#passwordError").focus();$("#passwordError").hasClass("hideContent")&&$("#passwordError").removeClass("hideContent");window.buttonLoading(document.querySelector("#password"),!1,t)}})):($("#passwordError").html(i),$("#passwordError").focus(),$("#passwordError").hasClass("hideContent")&&$("#passwordError").removeClass("hideContent"),window.buttonLoading(document.querySelector("#password"),!1,t))});$("#security").unbind().click(function(n){n.preventDefault();t=$("#security")[0].innerText;window.buttonLoading(document.querySelector("#security"),!0,"Submitting form...");var i=new FormData,f=!0,e="",r=$("#QuestionId").val(),u=$("#Answer").val();(r===null||r===undefined||r==="")&&(e="Question is required.",f=!1);(u===null||u===undefined||u==="")&&(e="Answer is required.",f=!1);f?(i.append("CustomerId",$("#CustomerId").val()),i.append("QuestionId",r),i.append("Answer",u),$.ajax({url:"/MyAccount/UpdateSecurity",beforeSend:function(){$(".spinner").show()},type:"Post",data:i,contentType:!1,processData:!1,cache:!1,complete:function(){$(".spinner").hide()},success:function(n){n.success?($("#securitySuccess").html("security details changed successfully."),$("#securitySuccess").focus(),$("#securitySuccess").hasClass("hideContent")&&$("#securitySuccess").removeClass("hideContent"),$("#securityError").hasClass("hideContent")||$("#securityError").addClass("hideContent")):($("#securityError").html(n.errorMessage),$("#securityError").hasClass("hideContent")&&$("#securityError").removeClass("hideContent"));window.buttonLoading(document.querySelector("#security"),!1,t);setTimeout(function(){window.location.reload()},2e3)},error:function(){$("#securityError").html(data.errorMessage);$("#securityError").focus();$("#securityError").hasClass("hideContent")&&$("#securityError").removeClass("hideContent");window.buttonLoading(document.querySelector("#security"),!1,t)}})):($("#securityError").html(e),$("#securityError").focus(),$("#securityError").hasClass("hideContent")&&$("#securityError").removeClass("hideContent"),window.buttonLoading(document.querySelector("#security"),!1,t))});$("#NewPassword, #ConfirmPassword").keyup(a);$(".niNumber").unbind().click(function(t){t.preventDefault();$.each($("._link"),function(n,t){t.innerHTML==="Settings"?$(this).addClass("--active"):$(this).removeClass("--active")});n="Settings";u(1)});$("#submitOrderPayment").unbind().submit(function(){return($("#btnPayPalOrder").prop("disabled",!0),f)?(f=!1,!0):(h(),!1)});$("#postcode").unbind().blur(function(n){n.preventDefault();var i=new RegExp("^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$"),t=$(this).val().toUpperCase();t.length>0&&($(this).val(t),i.test(t)?($("#postcode").hasClass("--invalid")&&$("#postcode").removeClass("--invalid"),$("#personalError").hasClass("hideContent")||$("#personalError").addClass("hideContent")):($("#personalError").removeClass("hideContent"),$("#postcode").hasClass("--invalid")||$("#postcode").addClass("--invalid")))});$("#refresh").unbind().click(function(n){n.preventDefault();window.location.reload()});$("#resendEmail").unbind().click(function(n){n.preventDefault();e()})}function a(){var n=$("#NewPassword").val(),t=$("#ConfirmPassword").val(),i=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&^#])[A-Za-z\\d@$!%*?&^#]{8,48}$");$("#ConfirmPassword").is(":focus")&&!i.test(n)?($("#passwordError").html("The password entered does not follow the rules. Please enter a password as described below and then try again."),$("#NewPassword").addClass("--invalid"),$("#passwordError").hasClass("hideContent")&&$("#passwordError").removeClass("hideContent")):t!==null&&t!==undefined&&t.trim()!==""&&n!==t?($("#passwordError").html("The passwords entered do not match. Please enter the confirmation password again."),$("#NewPassword").removeClass("--invalid"),$("#ConfirmPassword").addClass("--invalid"),$("#passwordError").hasClass("hideContent")&&$("#passwordError").removeClass("hideContent")):n===null||n===undefined||n.trim()===""?($("#passwordError").html("The password entered does not follow the rules. Please enter a password as described below and then try again."),$("#NewPassword").addClass("--invalid"),$("#passwordError").hasClass("hideContent")&&$("#passwordError").removeClass("hideContent")):($("#NewPassword").removeClass("--invalid"),$("#ConfirmPassword").removeClass("--invalid"),$("#passwordError").hasClass("hideContent")||$("#passwordError").addClass("hideContent"))}function v(){$.each($("._link"),function(){$("a").removeClass("--active")});$("a._link:contains('Account Package')").addClass("--active");n="Account Package";u(1)}function y(n){$.ajax({url:"/MyAccount/Investment",beforeSend:function(){},type:"POST",data:{customerPaymentId:n},cache:!1,complete:function(){},success:function(n){console.log(n)},error:function(n,t,i){console.log(n+i)}})}var r="Date",i="asc",n,f=!1,t="";return{setUpEvents:s,loadPartialView:v,paymentSuccess:y}}(),Redirect=function(){"use strict";function n(n,t,i){$.ajax({url:"/Offers/Transfer",beforeSend:function(){},type:"GET",data:{offerId:n,membershipCard:t,token:i},cache:!1,complete:function(){},success:function(n){console.log(n);n.success&&(window.location.href=n.data)},error:function(){}})}return{setUpEvents:n}}();